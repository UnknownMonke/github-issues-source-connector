{
  "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/86198",
  "repository_url": "https://api.github.com/repos/kubernetes/kubernetes",
  "labels_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/86198/labels{/name}",
  "comments_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/86198/comments",
  "events_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/86198/events",
  "html_url": "https://github.com/kubernetes/kubernetes/issues/86198",
  "id": 536763038,
  "node_id": "MDU6SXNzdWU1MzY3NjMwMzg=",
  "number": 86198,
  "title": "Scheduler should handle pod annotation updates during scheduling more gracefully",
  "user": {
    "login": "hex108",
    "id": 765591,
    "node_id": "MDQ6VXNlcjc2NTU5MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/765591?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hex108",
    "html_url": "https://github.com/hex108",
    "followers_url": "https://api.github.com/users/hex108/followers",
    "following_url": "https://api.github.com/users/hex108/following{/other_user}",
    "gists_url": "https://api.github.com/users/hex108/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hex108/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hex108/subscriptions",
    "organizations_url": "https://api.github.com/users/hex108/orgs",
    "repos_url": "https://api.github.com/users/hex108/repos",
    "events_url": "https://api.github.com/users/hex108/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hex108/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [
    {
      "id": 122775691,
      "node_id": "MDU6TGFiZWwxMjI3NzU2OTE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/cleanup",
      "name": "kind/cleanup",
      "color": "c7def8",
      "default": false,
      "description": "Categorizes issue or PR as related to cleaning up code, process, or technical debt."
    },
    {
      "id": 125550211,
      "node_id": "MDU6TGFiZWwxMjU1NTAyMTE=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/sig/scheduling",
      "name": "sig/scheduling",
      "color": "d2b48c",
      "default": false,
      "description": "Categorizes an issue or PR as relevant to SIG Scheduling."
    },
    {
      "id": 267761362,
      "node_id": "MDU6TGFiZWwyNjc3NjEzNjI=",
      "url": "https://api.github.com/repos/kubernetes/kubernetes/labels/kind/feature",
      "name": "kind/feature",
      "color": "c7def8",
      "default": false,
      "description": "Categorizes issue or PR as related to a new feature."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "hex108",
    "id": 765591,
    "node_id": "MDQ6VXNlcjc2NTU5MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/765591?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hex108",
    "html_url": "https://github.com/hex108",
    "followers_url": "https://api.github.com/users/hex108/followers",
    "following_url": "https://api.github.com/users/hex108/following{/other_user}",
    "gists_url": "https://api.github.com/users/hex108/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hex108/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hex108/subscriptions",
    "organizations_url": "https://api.github.com/users/hex108/orgs",
    "repos_url": "https://api.github.com/users/hex108/repos",
    "events_url": "https://api.github.com/users/hex108/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hex108/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "hex108",
      "id": 765591,
      "node_id": "MDQ6VXNlcjc2NTU5MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/765591?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hex108",
      "html_url": "https://github.com/hex108",
      "followers_url": "https://api.github.com/users/hex108/followers",
      "following_url": "https://api.github.com/users/hex108/following{/other_user}",
      "gists_url": "https://api.github.com/users/hex108/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hex108/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hex108/subscriptions",
      "organizations_url": "https://api.github.com/users/hex108/orgs",
      "repos_url": "https://api.github.com/users/hex108/repos",
      "events_url": "https://api.github.com/users/hex108/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hex108/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2019-12-12T05:19:39Z",
  "updated_at": "2020-01-01T01:03:41Z",
  "closed_at": "2020-01-01T01:03:41Z",
  "author_association": "CONTRIBUTOR",
  "type": null,
  "active_lock_reason": null,
  "sub_issues_summary": {
    "total": 0,
    "completed": 0,
    "percent_completed": 0
  },
  "issue_dependencies_summary": {
    "blocked_by": 0,
    "total_blocked_by": 0,
    "blocking": 0,
    "total_blocking": 0
  },
  "body": "<!-- Please only use this template for submitting enhancement requests -->\r\n\r\n**What would you like to be added**:\r\n\r\nSimilar problem as https://github.com/kubernetes/kubernetes/issues/52914, howerver in our case, pod's annotation was updated at scheduling cycle, so it had not been assumed when its annotation was updated. We also need to deal with this case.\r\n\r\nDetailed steps:\r\n1. Created a pod `juntest-7c7f74ccdc-zrh6l`.\r\n2. Scheduler tried to schedule the pod. Then it was prediated by a filter plugin that we write. This plugin modified the pod's annotation to record something. Because pod's annotation changed, scheduuler received a pod update event, and put the pod to the schedule queue again.\r\n3. Scheduler scheduled the pod successfully for this schedule cycle.\r\n4. Scheduler tried to schedule the updated pod again(it was put to the schedule queue at step 2). If the pod was scheduled sucessfully, we would see the error log(`scheduler cache AssumePod failed: pod default/juntest-7c7f74ccdc-zrh6l state wasn't initial but get assumed`) in scheduler. If scheduler failed to schedue the pod, scheduler would send a failed scheduler event to pod. They are both confusing because the pod had already been successfully.\r\n\r\n![scheduler2](https://user-images.githubusercontent.com/765591/70684701-0036cf00-1ce2-11ea-930b-f93d7191e297.png)\r\n\r\n**Why is this needed**:\r\n\r\nIt will be better to handle pod annotation updates during scheduling more gracefully.\r\n\r\n/kind cleanup\r\n/sig scheduling\r\n/assign",
  "closed_by": {
    "login": "k8s-ci-robot",
    "id": 20407524,
    "node_id": "MDQ6VXNlcjIwNDA3NTI0",
    "avatar_url": "https://avatars.githubusercontent.com/u/20407524?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/k8s-ci-robot",
    "html_url": "https://github.com/k8s-ci-robot",
    "followers_url": "https://api.github.com/users/k8s-ci-robot/followers",
    "following_url": "https://api.github.com/users/k8s-ci-robot/following{/other_user}",
    "gists_url": "https://api.github.com/users/k8s-ci-robot/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/k8s-ci-robot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k8s-ci-robot/subscriptions",
    "organizations_url": "https://api.github.com/users/k8s-ci-robot/orgs",
    "repos_url": "https://api.github.com/users/k8s-ci-robot/repos",
    "events_url": "https://api.github.com/users/k8s-ci-robot/events{/privacy}",
    "received_events_url": "https://api.github.com/users/k8s-ci-robot/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/kubernetes/kubernetes/issues/86198/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/kubernetes/kubernetes/issues/86198/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}